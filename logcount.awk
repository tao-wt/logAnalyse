#spaceanalysespacecmp'sspacelogPLY#spacestartspacethespaceanalysespacescriptspacewhilespacetestspaceisspacestablespacePLY#spacewriterspaceSY60216spacePLY#spaceusage:PLY#TABTABTABawkspace-vspaces="01-20space9:45:56.111"space-vspacee="2-28space13:45:25.000"space-fspaceawkfilename.awkspaceinputfilePLYPLYBEGIN{PLYTABprintspace"st:",st,"en:",enPLYTABstlen=split(st,sta,"space")PLYTABtimeStart=countTime(sta[slten-1],sta[stlen])PLYTABenlen=split(en,ena,"space")PLYTABtimeEnd=countTime(ena[enlen-1],ena[enlen])PLYTABitime=0PLYTABreceiveId=0PLYTABrealTime1=""PLYTABrealTime2=""PLYTABoutfile="./out/timeoutLog"PLYTABoutfile_2="./out/methodaevent"PLYTABsystem("rmspace-rfspace"spaceoutfile)PLYTABsystem("rmspace-rfspace"spaceoutfile_2)PLYTABsystem("rmspace-rfspace./out/*space")PLYTABprintspace"请等待..."PLY}PLYfunctionspacecountTime(getDate,getTime)PLY{PLYTABdatelen=split(getDate,idate,"-")PLYTABmouth=idate[datelen-1]PLYTABdate=idate[datelen]PLYTABtimel=split(getTime,itimes,":")PLYTABhour=itimes[1]PLYTABminute=itimes[2]PLYTABsecondl=split(itimes[timel],s,".")PLYTABsecond=s[1]PLYTABmillis=s[secondl]PLYTABcount=(mouth-1)*30*24*60*60*1000+date*24*60*60*1000+hour*60*60*1000+minute*60*1000+second*1000+millisPLYTABreturnspacecountPLY}PLYfunctionspaceiAnalyse(ivar)PLY{PLY}PLY{PLYTABif($0~/^2017\-02\-1[3-9]\space[0-2][0-9]\:[0-5][0-9]\:/)PLYTAB{PLYTABTABrealTime1=$1;realTime2=$2;PLYTABTABitime=countTime(realTime1,realTime2)PLYTABTABif(itime>timeEnd)spaceexitPLYTAB}PLYTABelsespaceif($0~/^Transaction\spaceFROM\spaceclient\spacesend\spaceTimeout.*/space&&spaceitime>timeStartspace&&spaceitime<timeEnd)PLYTAB{PLYTABTABprintspace"================================="PLYTABTABprintspacerealTime1,realTime2PLYTABTABMethod=""PLYTABTABEvent=""PLYTABTABfor(;getlinespace&&space$0!~/^2017\-02\-[0-2][0-9]\space[0-2][0-9]\:[0-5][0-9]\:/;)PLYTABTAB{PLYTABTABTABif($0~/^Method.*/)spacePLYTABTABTAB{PLYTABTABTABTABsub(/\r/,"",$0)PLYTABTABTABTABlenS=split($0,A1SS,"space:space")PLYTABTABTABTABMethod=A1SS[lenS]PLYTABTABTABTABPLYTABTABTAB}PLYTABTABTABif($0~/^Event.*/)spacePLYTABTABTAB{PLYTABTABTABTABsub(/\r/,"",$0)PLYTABTABTABTABlenS=split($0,A1SS,"space:space")PLYTABTABTABTABlenSS=split(A1SS[lenS],A1SSS,"|")PLYTABTABTABTABlenSSS=split(A1SSS[2],A1SSSS,")")PLYTABTABTABTABEvent=A1SSSS[2]PLYTABTABTABTABPLYTABTABTAB}PLYTABTABTABif($0~/^Transaction\spaceFROM\spaceclient\spacesend\spaceTimeout.*/)spacereceiveId++PLYTABTAB}PLYTABTABprintf("%sspace%s/%s\n",++receiveId,Method,Event)>>outfilePLYTABTABclose(outfile)PLYTABTABprintf("%sspace%s/%s\n",receiveId,Method,Event)PLYTABTABMAE=Methodspace"/"spaceEventPLYTABTABif(MAEspaceinspacearray)PLYTABTAB{PLYTABTABTABarray[MAE]+=1PLYTABTAB}PLYTABTABelsePLYTABTAB{PLYTABTABTABarray[MAE]=1PLYTABTAB}PLYTABTABfor(namespaceinspacearray)PLYTABTABTABprintspacename,array[name]space>outfile_2PLYTABTABclose(outfile_2)PLYTABTABif($0~/^2017\-02\-[0-2][0-9]\space[0-2][0-9]\:[0-5][0-9]\:/)PLYTABTAB{PLYTABTABTABrealTime1=$1;realTime2=$2;PLYTABTABTABitime=countTime(realTime1,realTime2)PLYTABTABTABif(itime>timeEnd)spaceexitPLYTABTAB}PLYTAB}PLY}PLYEND{PLYTABprintspace"================================="PLYTABprintf("thespacesumspaceofspaceTransactionspaceFROMspaceclientspacesendspaceTimeoutspacepacketsspaceisspace:%d\n",receiveId)PLYTABfor(namespaceinspacearray)PLYTABTABprintspacename,array[name]PLY}PLYPLY
